물체 로컬리제이션

-학습 목표-
물체 로컬리제이션에 대해 학습

물체를 인지하는 것을 넘어서 물체의 위치를 알아내는 것이 
물체 로컬라이제이션이다.

핵심 키워드 - 물체 인식(object detection), 물체 로컬리제이션( object localization),
		경계상자(bounding box)

요약-------
물체 인식을 설계하기 위해서는 먼저 물체 로컬리제이션을 배워야 한다. 
Object localization

localization과 detection이란 무엇인가?

이미지 분류, localization을 통한 분류, 탐지

Image 분류와 Classification with localization의 경우
하나의 물체 보통 이미지의 가운데 부분에 큰 크기의 물체 하나만을 가진다.

반면 Detection의 경우에는 여러개의 물체들이 모두 다른 종류일 수 있다.

자율주행 자동차를 설계하는 경우
1. 보행자
2. 차
3. 오토바이
4 배경 ( 아무것도 없을 때)
에 대한 물체 분류
이 네가지 가능성의 출력을 가지는 소프트 맥스를 활성층의 분류로 사용하면 될 것이다.

경계상자에 관한 출력을 추가적으로 더 가져야한다.

b_x,b_y,b_h,b_w로써 네 가지 변수는 감지된 물체에 대한 경계상자의 변수를 나타낸다. 이를 소프트맥스의 출력을 통해
알아내고 이값을 통해 물체의 경계와 위치가 어디있는지 파악할 수 있게 된다.
올바른 경계변수가 출력되면 올바른 위치에 물체가 감지되었음이 파악 가능해진다.

레이블 y에서 p_c는 물체가 있는지 나타내는 확률이고 p_c가 0이면 물체가 없는 배경임을 의미.

핵심= 물체의 위치를 파악하는 (경계상자)를 이용한다,

소프트맥스층을 이용한 분류레이블을 클래스분류 말고도
pc = 물체가 있는지 없는지 나타내는 확률
bx = 경계상자 변수
by = 경계상자 변수
bw = 경계상자 변수
bh = 경계상자 변수
c1 = 분류 클래스
c2등등
으로 나누어서 출력레이블 y를 출력하고 pc가 0인지 1인지를 나누어서 손실함수를 계산한다.
pc가 0이라면 나머지 항은 계산할 필요가 없는 don't care 항이 된다.

학습 내용-----

물체 로컬리제이션이란 이미지에서 물체를 분류하고 그 위치까지 감지하는 작업을 의미
따라서 최종 출력 층에는 해당 물체의 클래스 뿐만 아니라 위치까지 알 수 있는 경계상자를 출력해야한다.

bx,by는 물체의 경계상자 중심점의 좌표이다.

최종 출력/라벨형태
object probability (pc) : 물체 존재여부의 확률
bounding boxf : 경계상자 위치
classes : 0과 1로 구성된 해당 물체 클래스의 라벨이다.

타겟 데이터의 형태는 어떨까?

만약 2번째 클래스인 물체라면 (즉 ,자동차가 있는 사진) pc 값은 1이 되고 물체있으니까,
c2는 1 나머지 클래스는 0이 된다.

하지만 만약에 물체가 없고 배경만 있다면, pc 값은 0이되고 나머지 값들은 상관없는 무관계항이됨.

손실함수는 물체가 있는가 없는가 에 따라서 나눠야 한다.
그냥 모든 항을 MSE 손실함수 사용하면 되긴 하지만 자세히 한다면 pc는 로지스틱 회귀함수,
경계상자값은 MSE, 클래스 분류는 로그 우도 함수를 사용하는 것이 좋다.





